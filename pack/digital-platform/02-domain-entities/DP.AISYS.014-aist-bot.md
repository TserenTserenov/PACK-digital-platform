---
id: DP.AISYS.014
name: AIST Bot
type: ai-system-passport
status: draft
summary: "Telegram-бот экосистемы: тонкий клиент с сервисным реестром, ИИ-консультантом, биллингом и связью с цифровым двойником"
created: 2026-02-11
trust:
  F: 3
  G: domain
  R: 0.5
epistemic_stage: emerging
orientation: human
initiative: both
interface: dialogue
related:
  uses: [DP.ARCH.001, DP.AGENT.001, DP.NAV.001]
  integrates: [DP.AISYS.012, DP.AISYS.013]
---

# AIST Bot (@aist_me_bot)

## 1. Определение

**AIST Bot** — ИИ-система (Telegram-бот), которая является основной точкой входа пользователя в экосистему. Тонкий клиент с сервисным реестром: подключает обучение, планирование, заметки, консультант, биллинг и цифровой двойник через единый интерфейс.

> Бот ≠ платформа. Бот = тонкий клиент, который маршрутизирует пользователя к сервисам.

## 2. Классификация

| Характеристика | Значение | Пояснение |
|----------------|----------|-----------|
| **Ориентация** | human | Работает напрямую с пользователем в Telegram |
| **Инициатива** | both | Отвечает на команды (reactive) и отправляет уведомления (proactive) |
| **Интерфейс** | dialogue | Telegram chat + inline keyboards + Mini Apps (для сложного UI) |

## 3. Архитектурные характеристики

| Характеристика | Определение | Как реализуется |
|----------------|-------------|-----------------|
| **Эволюционируемость** | Бесконечное подключение сервисов, БД, MCP без изменения структуры | Сервисный реестр: новый сервис = запись в реестре → меню обновляется |
| **Масштабируемость** | Бесконечное подключение пользователей без изменения архитектуры | `menu(user) = registry.filter(access).render()` — персонализация при росте |
| **Обучаемость** | Платформа улучшает решения на основе данных и обратной связи | Аналитика поведения → адаптивное меню + консультант с self-knowledge |
| **Генеративность** | Платформа порождает созидателей | Путь знания (заметка → Pack → продукт) + fork шаблона экзокортекса |

## 4. Слоёная архитектура

```
┌─────────────────────────────────────────────┐
│         СЛОЙ 1: Консультант (Self-Help)      │
│  Всегда доступен, знает бота, deep links     │
│  База знаний: о боте + о домене (через MCP)  │
├─────────────────────────────────────────────┤
│         СЛОЙ 2: Меню-генератор               │
│  menu(user) = registry.filter(access).render │
│  Сервисный реестр → фильтр по роли/подписке  │
├─────────────────────────────────────────────┤
│         СЛОЙ 3: Сервисы (домены)             │
│  Обучение | Планы | Заметки | Двойник | ...  │
│  Каждый сервис = модуль с собственным SM     │
├─────────────────────────────────────────────┤
│         СЛОЙ 4: Доступ + Биллинг             │
│  Роли, подписки, покупки курсов, paywall     │
│  3 типа: подписка + курсы + фичи            │
├─────────────────────────────────────────────┤
│         СЛОЙ 5: Аналитика + Обучаемость      │
│  Поведение → адаптация меню → улучшение UX   │
│  Цифровой двойник → персональная траектория  │
└─────────────────────────────────────────────┘
```

### 4.1. Слой 1: Консультант (Self-Help)

Консультант — это **слой поверх всего бота**, не отдельный домен в меню.

| Свойство | Значение |
|----------|----------|
| Доступ | Текстовый ввод без команды + кнопка `❓` в каждом меню |
| Знание о боте | База знаний о структуре, командах, путях (обновляется из реестра сервисов) |
| Знание о домене | Через MCP (guides, knowledge) |
| Deep links | Может не только объяснить, но и перенаправить в нужный сервис |

#### 4.1.1. Self-Knowledge (Самознание)

Трёхуровневая модель самознания — бот знает о себе и может точно отвечать на вопросы о своей структуре и возможностях. **Эта секция — source-of-truth** для знаний бота о себе. Бот читает её при запуске и кеширует.

| Уровень | Содержит | Источник | Обновляется | Скорость |
|---------|----------|----------|-------------|----------|
| **L1: Кеш** | Описания, сценарии, FAQ (из этой секции) + граф сервисов из реестра | Pack (этот файл) → кеш в памяти | Раз в день / при рестарте | ~100ms |
| **L2: MCP** | Полная база знаний Pack через MCP + быстрая модель | MCP-запрос к Pack | По запросу | ~1-3 сек |
| **L3: Полный поиск** | MCP guides + knowledge + Sonnet | MCP-поиск + Claude | По запросу | ~3-8 сек |

**Реализация:** `core/self_knowledge.py` — читает эту секцию из Pack, мержит с ServiceRegistry, кеширует по языкам.

**Три пути обработки вопросов:**
- L1: FAQ-матч или частый вопрос → мгновенный ответ из кеша
- L2: Вопрос о боте, не в кеше → Claude Haiku + self-knowledge (без MCP-поиска)
- L3: Доменный вопрос → MCP-поиск + Claude Sonnet + self-knowledge в system prompt

##### Идентичность бота

**Имя:** AIST Bot (@aist_me_bot)

**Назначение (ru):** Бот-наставник для систематического обучения и личного развития. Помогает изучать системное мышление через структурированные программы, отвечает на вопросы, ведёт заметки и отслеживает прогресс.

**Назначение (en):** Mentor bot for systematic learning and personal development. Helps study systems thinking through structured programs, answers questions, keeps notes, and tracks progress.

**Как задать вопрос (ru):** Начни сообщение с `?` чтобы задать вопрос консультанту в любой момент.

**Как задать вопрос (en):** Start your message with `?` to ask the consultant a question at any time.

##### Сценарии

| # | Сценарий | Команда | Описание (ru) | Описание (en) |
|---|----------|---------|---------------|---------------|
| 1 | Онбординг | `/start` | Первый запуск: знакомство, заполнение профиля, выбор режима | First launch: introduction, profile setup, mode selection |
| 2 | Выбор режима | `/mode` | Переключение между Марафоном, Лентой и другими программами | Switch between Marathon, Feed, and other programs |
| 3 | Марафон | `/learn` (mode=marathon) | 14-дневная программа: каждый день теория → вопрос на понимание → бонусный вопрос → практическое задание. Прогресс сохраняется | 14-day program: daily theory → comprehension question → bonus question → practical task. Progress is saved |
| 4 | Лента | `/learn` (mode=feed) | Гибкий режим: выбираешь до 3 тем, получаешь ежедневные дайджесты с углублением | Flexible mode: choose up to 3 topics, receive daily digests with increasing depth |
| 5 | Тест систематичности | `/test` | Data-driven тест уровня системного мышления по таксономии Блума (знание → понимание → применение). Результат с персональной рекомендацией | Data-driven systems thinking assessment using Bloom taxonomy. Results with personal recommendation |
| 6 | Консультация | `?вопрос` | Задать вопрос консультанту из любого места в боте. Ответ на основе базы знаний и MCP | Ask the consultant a question from anywhere in the bot. Answer based on knowledge base and MCP |
| 7 | Заметки | `.текст` | Три способа: `.текст` (прямая), `.` + reply, `.` + forward. Заметки сохраняются для анализа | Three ways: `.text` (direct), `.` + reply, `.` + forward. Notes are saved for analysis |
| 8 | Прогресс | `/progress` | Статистика обучения: пройденные темы, текущий день марафона, выполненные задания | Learning stats: completed topics, current marathon day, completed tasks |
| 9 | Планы (Стратег) | `/rp`, `/plan`, `/report` | Интеграция со Стратегом: список рабочих продуктов, план на неделю, отчёт | Strategist integration: work products list, weekly plan, report |
| 10 | Настройки | `/settings` | Язык интерфейса, имя, профессия, интересы. Языки: ru, en, es, fr | Interface language, name, occupation, interests. Languages: ru, en, es, fr |
| 11 | Цифровой двойник | `/twin` | Персональный профиль: данные об обучении, интересах и прогрессе для рекомендаций | Personal profile: learning data, interests, and progress for recommendations |
| 12 | Помощь | `/help` | Полный список команд и возможностей бота с описаниями | Full list of bot commands and capabilities with descriptions |
| 13 | Экспорт | `/export` | Экспорт данных пользователя | Export user data |

##### FAQ

| # | Вопрос (ru) | Вопрос (en) | Ключевые слова | Ответ (ru) | Ответ (en) |
|---|-------------|-------------|----------------|------------|------------|
| 1 | Как начать обучение? | How to start learning? | начать, старт, start, begin | Используй `/learn`. Если ещё не выбран режим — бот предложит выбрать Марафон или Ленту через `/mode`. | Use `/learn`. If no mode is selected yet, the bot will offer to choose Marathon or Feed via `/mode`. |
| 2 | Как работает Марафон? | How does the Marathon work? | марафон, marathon, 14 дн | Марафон — 14-дневная программа. Каждый день: теоретический урок + практическое задание. Прогресс сохраняется, можно продолжить с того места, где остановился. | Marathon is a 14-day program. Each day: theory lesson + practical task. Progress is saved, you can continue where you left off. |
| 3 | Как работает Лента? | How does the Feed work? | лент, feed, дайджест | Лента — гибкий режим обучения. Выбираешь до 3 интересных тем, получаешь ежедневные дайджесты с постепенным углублением. | Feed is a flexible learning mode. Choose up to 3 topics, receive daily digests with gradual deepening. |
| 4 | Как сменить язык? | How to change the language? | язык, language, english | Открой `/settings` и выбери нужный язык. Доступны: русский, английский, испанский, французский. | Open `/settings` and select the desired language. Available: Russian, English, Spanish, French. |
| 5 | Как создать заметку? | How to create a note? | замет, note, запис | Три способа: 1) `.текст` — точка и текст. 2) Ответь на сообщение с точкой. 3) Перешли сообщение и добавь точку. | Three ways: 1) `.text` — dot and text. 2) Reply to a message with a dot. 3) Forward a message and add a dot. |
| 6 | Как пройти тест? | How to take the test? | тест, оценк, assessment, уров | Используй `/test` — бот проведёт тест систематичности и покажет результат с рекомендацией. | Use `/test` — the bot will conduct an assessment and show results with a recommendation. |
| 7 | Как задать вопрос? | How to ask a question? | помощ, помог, help, вопрос | Начни сообщение с `?` и напиши вопрос. Например: `?Что такое системное мышление?` Консультант доступен из любого места. | Start with `?` and type your question. Example: `?What is systems thinking?` The consultant is available from anywhere. |
| 8 | Как работать с планами? | How to work with plans? | план, рп, plan, report | Используй `/rp` для списка рабочих продуктов, `/plan` для плана на неделю, `/report` для отчёта. Интегрировано со Стратегом. | Use `/rp` for work products, `/plan` for weekly plan, `/report` for a report. Integrated with the Strategist. |

### 4.2. Слой 2: Меню-генератор

Меню **генерируется** из реестра сервисов, а не захардкожено.

```
Реестр сервисов (конфиг/БД)
  → Фильтр по роли + подписке пользователя
    → Группировка по категориям
      → Генерация inline keyboard
```

**Принцип:** добавил новый MCP-сервис → добавил запись в реестр → меню обновилось. Ноль изменений в UI-коде.

### 4.3. Слой 3: Сервисы (домены)

| Домен | Что делает | Текущий статус |
|-------|-----------|----------------|
| **Обучение** | Марафон (14 дней) + Лента (гибкий режим) + тестирование | Active |
| **Планы** | Интеграция со Стратегом: /rp, /plan, /report | Active |
| **Заметки** | Исчезающие заметки: «.текст», «.» + reply/forward | Active |
| **Консультант** | ИИ через MCP: ответы на вопросы по знаниям | In progress |
| **Цифровой двойник** | Персональный профиль + индивидуальная траектория | In progress |
| **Расписание** | Курсы, события, уведомления | Planned |
| **Биллинг** | Подписка + курсы + фичи | Planned |

**Каждый домен = отдельный модуль** (handler + states + engine). Добавление нового домена не затрагивает существующие.

### 4.4. Слой 4: Доступ + Биллинг

Биллинг — **слой доступа**, не домен в меню.

| Тип платного | Механизм | Как влияет на UI |
|-------------|----------|------------------|
| **Подписка** | Рекуррентная (бот) | Определяет набор доступных сервисов |
| **Курсы** | Разовая покупка | Открывает конкретный курс в сервисе «Обучение» |
| **Фичи** | Paywall на функцию | Показывает paywall в момент попытки доступа |

```
user.has_access(service) = user.subscription ∪ user.purchases ∪ user.role
```

### 4.5. Слой 5: Аналитика + Цифровой двойник

| Функция | Данные | Результат |
|---------|--------|-----------|
| Частотный анализ | Какие кнопки нажимают | Адаптивный порядок меню |
| Анализ застреваний | Где нажимают «Назад» | Упрощение навигации |
| Цифровой двойник | Профиль + прогресс + заметки | **Персональная траектория обучения** |
| Индивидуальные сценарии | Двойник + контекст | Рекомендации: что учить следующим |

## 5. UX-принципы

### 5.1. Progressive Disclosure

- Главное меню: 4-6 кнопок-доменов (не больше)
- Каждый домен раскрывается в под-меню
- Глубина навигации: **максимум 3 уровня**
- Новые функции появляются по мере роста пользователя

### 5.2. Inline Keyboard vs Mini App

| Инструмент | Когда |
|-----------|-------|
| **Inline Keyboard** | Выбор из 2-8 опций, подтверждения, навигация ≤3 уровней |
| **Mini App (WebApp)** | Расписание (календарь), дашборд прогресса, оплата, длинные формы |

**Критерий перехода:** если keyboard уходит глубже 3 уровней или показывает >50 элементов → Mini App.

### 5.3. Навигация

- **Persistent Menu** (`/start`, `/learn`, `/plan`, `/help`) — всегда через «/»
- **Контекстное меню** — после каждого действия 2-3 релевантные кнопки
- **Callback routing** — паттерн `domain:action:param` (масштабируемый)
- **`edit_message_reply_markup`** вместо нового сообщения (чат не засоряется)
- **Кнопка «← Назад»** на каждом уровне

### 5.4. Антипаттерны

- Стена кнопок (>8 в одном сообщении)
- Глубокая навигация без «Назад»
- Смешение доменов в одном меню
- Повторная отправка всего меню (вместо `edit_message`)

## 6. Текущая реализация

### 6.1. State Machine

**Архитектура:** YAML-driven State Machine (transitions.yaml → states/ → handlers/).

```
Telegram Update → Middleware → Router → Dispatcher → SM.handle()
  → Current State.handle() → event → transitions.yaml → Next State.enter()
```

### 6.2. Режимы обучения (mode-aware routing)

| Режим | Стейты | Как попасть |
|-------|--------|------------|
| **Марафон** | workshop.marathon.* (lesson → question → bonus → task) | /learn при mode=marathon |
| **Лента** | feed.* (topics → digest) | /learn при mode=feed |

**`get_user_mode_state(user)`** — единая точка определения целевого стейта по режиму.

### 6.3. Интеграции

| Система | Интерфейс | Текущий статус |
|---------|-----------|----------------|
| Claude API | `clients/claude.py` | Active |
| MCP guides/knowledge | `core/knowledge.py` | Active |
| PostgreSQL | `core/storage.py` | Active |
| GitHub API | `handlers/github.py` | In progress |
| Стратег | `handlers/strategist.py` | In progress |
| Цифровой двойник | `handlers/twin.py` | In progress |

## 7. Переносимость (отчуждаемость)

> Platform-space ≠ User-space (DP.D.011)

**Platform-space (одинаково для всех):**
- State Machine engine (core/machine.py)
- Сервисный реестр (генерация меню)
- Слой биллинга (подписки, paywall)
- i18n framework (4 языка)
- Шаблоны стейтов (BaseState lifecycle)

**User-space (уникально для пользователя):**
- Контент курсов (topics/, knowledge_structure.yaml)
- MCP-подключения (конкретные Pack'и)
- Настройки биллинга (цены, планы подписки)
- Брендирование (имя бота, тексты)

## 8. Эволюция (фазы)

| Фаза | Цель | Архитектурное изменение |
|------|------|------------------------|
| **0 (текущая)** | Mode-aware routing + стабилизация | SM + handlers |
| **1** | Сервисный реестр + консультант | Меню из реестра, self-help слой |
| **2** | Тонкий клиент + агенты | Бот = UI, вся логика в MCP/агентах |
| **3** | Цифровой двойник + траектории | Индивидуальные сценарии, адаптивное обучение |

## 9. Реализация (Downstream)

| Репо | Ветка | Статус |
|------|-------|--------|
| [DS-aist-bot](https://github.com/TserenTserenov/DS-aist-bot) / aist_bot_newarchitecture | new-architecture | Active |

## 10. Связанные документы

- [DP.ARCH.001 Архитектура платформы](DP.ARCH.001-platform-architecture.md) — бот = Слой 1 (Interface)
- [DP.AGENT.001 ИИ-агенты](DP.AGENT.001-ai-agents.md) — классификация, реестр
- [DP.AISYS.012 Стратег](DP.AGENT.012-strategist/00-agent-passport.md) — интеграция /rp, /plan, /report
- [DP.AISYS.013 Знание-Экстрактор](DP.AISYS.013-knowledge-extractor.md) — заметки → inbox → Pack
- [DP.CONCEPT.001 Концепция платформы](DP.CONCEPT.001-platform-concept.md) — общая концепция
- [DP.NAV.001 Навигация знаний](DP.NAV.001-knowledge-navigation.md) — MCP-поиск
